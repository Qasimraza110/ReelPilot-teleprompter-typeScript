(()=>{"use strict";let e="auth",t="scripts",r="sync-queue",o=async()=>{let t=await new Promise((t,r)=>{let o=indexedDB.open("ReelPilotAuthDB",1);o.onupgradeneeded=t=>{let r=t.target.result;r.objectStoreNames.contains(e)||r.createObjectStore(e,{keyPath:"key"}),console.log("SW: Auth DB upgraded to version ".concat(1))},o.onsuccess=e=>{t(e.target.result)},o.onerror=e=>{console.error("SW: Error opening Auth IndexedDB:",e.target.error),r("Failed to open SW Auth IndexedDB")}});return new Promise((r,o)=>{let n=t.transaction([e],"readonly").objectStore(e).get("session_id");n.onsuccess=e=>{var t;r((null==(t=e.target.result)?void 0:t.value)||null)},n.onerror=e=>{console.error("SW: Error getting auth token from DB:",e.target.error),o(e.target.error)}})},n=()=>new Promise((e,o)=>{let n=indexedDB.open("ReelPilotDB",1);n.onupgradeneeded=e=>{let o=e.target.result;o.objectStoreNames.contains(t)||o.createObjectStore(t,{keyPath:"_id"}),o.objectStoreNames.contains(r)||o.createObjectStore(r,{autoIncrement:!0}),console.log("SW: Main DB upgraded to version ".concat(1))},n.onsuccess=t=>{e(t.target.result)},n.onerror=e=>{console.error("SW: Error opening Main IndexedDB:",e.target.error),o("Failed to open SW Main IndexedDB")}}),a=async()=>{let e=await n();return new Promise((t,o)=>{let n=e.transaction([r],"readonly").objectStore(r).openCursor(),a=[];n.onsuccess=e=>{let r=e.target.result;r?(a.push({key:r.key,item:r.value}),r.continue()):t(a)},n.onerror=e=>{console.error("SW: Error getting sync queue:",e.target.error),o(e.target.error)}})},s=async e=>{let t=await n();return new Promise((o,n)=>{let a=t.transaction([r],"readwrite").objectStore(r).delete(e);a.onsuccess=()=>{o()},a.onerror=e=>{console.error("SW: Error removing from sync queue:",e.target.error),n(e.target.error)}})},c=async e=>{let r=await n();return new Promise((o,n)=>{let a=r.transaction([t],"readwrite").objectStore(t).put(e);a.onsuccess=()=>o(),a.onerror=e=>{console.error("SW: Error updating script in main DB:",e.target.error),n(e.target.error)}})};importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.5.0/workbox-sw.js"),workbox.precaching.precacheAndRoute([{'revision':'702fcad5ec9e1d8837f244bcf59d1caf','url':'/_next/app-build-manifest.json'},{'revision':'f54d09b40857a41d','url':'/_next/static/chunks/316-f54d09b40857a41d.js'},{'revision':'716d46e6e5cb6bdc','url':'/_next/static/chunks/341.716d46e6e5cb6bdc.js'},{'revision':'a3826d29d6854395','url':'/_next/static/chunks/472.a3826d29d6854395.js'},{'revision':'cf72ae8a39fa05aa','url':'/_next/static/chunks/4bd1b696-cf72ae8a39fa05aa.js'},{'revision':'bf5777dc527b5e17','url':'/_next/static/chunks/726-bf5777dc527b5e17.js'},{'revision':'b6effe3eb41f5916','url':'/_next/static/chunks/906-b6effe3eb41f5916.js'},{'revision':'eda38e26c0391a47','url':'/_next/static/chunks/964-eda38e26c0391a47.js'},{'revision':'eafef13623e8ebe9','url':'/_next/static/chunks/app/_not-found/page-eafef13623e8ebe9.js'},{'revision':'42e2a57f2817a47c','url':'/_next/static/chunks/app/api/checkout/check-session/route-42e2a57f2817a47c.js'},{'revision':'42e2a57f2817a47c','url':'/_next/static/chunks/app/api/checkout/create-session/route-42e2a57f2817a47c.js'},{'revision':'42e2a57f2817a47c','url':'/_next/static/chunks/app/api/checkout/send-email/route-42e2a57f2817a47c.js'},{'revision':'42e2a57f2817a47c','url':'/_next/static/chunks/app/api/create-portal-session/route-42e2a57f2817a47c.js'},{'revision':'ccc62eb323880c97','url':'/_next/static/chunks/app/dashboard/page-ccc62eb323880c97.js'},{'revision':'65fbcb1e25ef2d09','url':'/_next/static/chunks/app/dashboard/scripts/edit/%5BscriptId%5D/page-65fbcb1e25ef2d09.js'},{'revision':'9cce4d8a422b660a','url':'/_next/static/chunks/app/dashboard/scripts/edit/page-9cce4d8a422b660a.js'},{'revision':'0685d1d66c287ec8','url':'/_next/static/chunks/app/dashboard/scripts/page-0685d1d66c287ec8.js'},{'revision':'7ab80ac51d8102e7','url':'/_next/static/chunks/app/forgot-pwd/page-7ab80ac51d8102e7.js'},{'revision':'90926347b2decb7f','url':'/_next/static/chunks/app/layout-90926347b2decb7f.js'},{'revision':'8f0b2ae3ca4e7dd2','url':'/_next/static/chunks/app/login/page-8f0b2ae3ca4e7dd2.js'},{'revision':'acc1c09a34716d12','url':'/_next/static/chunks/app/new/page-acc1c09a34716d12.js'},{'revision':'00ad775df469393c','url':'/_next/static/chunks/app/page-00ad775df469393c.js'},{'revision':'9521aac148e86fb3','url':'/_next/static/chunks/app/plans/page-9521aac148e86fb3.js'},{'revision':'6ba2049ce0888bcc','url':'/_next/static/chunks/app/plans/success/page-6ba2049ce0888bcc.js'},{'revision':'8f9144cdb932d6b6','url':'/_next/static/chunks/app/record/page-8f9144cdb932d6b6.js'},{'revision':'d0141b553ea66936','url':'/_next/static/chunks/app/reset-pwd/page-d0141b553ea66936.js'},{'revision':'e41e4098a5e1d85d','url':'/_next/static/chunks/app/signup/page-e41e4098a5e1d85d.js'},{'revision':'7c95b8e5103c9e90','url':'/_next/static/chunks/framework-7c95b8e5103c9e90.js'},{'revision':'2a5362f6be9cb565','url':'/_next/static/chunks/main-app-2a5362f6be9cb565.js'},{'revision':'fe60a7eed165e7d6','url':'/_next/static/chunks/main-fe60a7eed165e7d6.js'},{'revision':'dd8da8c4508089c7','url':'/_next/static/chunks/pages/_app-dd8da8c4508089c7.js'},{'revision':'544778206352ce59','url':'/_next/static/chunks/pages/_error-544778206352ce59.js'},{'revision':'846118c33b2c0e922d7b3a7676f81f6f','url':'/_next/static/chunks/polyfills-42372ed130431b0a.js'},{'revision':'0d08fcf9d6edaf7d','url':'/_next/static/chunks/webpack-0d08fcf9d6edaf7d.js'},{'revision':'16fad9a510843284','url':'/_next/static/css/16fad9a510843284.css'},{'revision':'9263f7ee5478d1acfb15734926fd9254','url':'/_next/static/jB2Hpiamn7poNkfU-cUYz/_buildManifest.js'},{'revision':'b6652df95db52feb4daf4eca35380933','url':'/_next/static/jB2Hpiamn7poNkfU-cUYz/_ssgManifest.js'},{'revision':'28457bc3dd64b2c4dae1ae4493a1934d','url':'/favicon.ico'},{'revision':'3237f4137fe0b0b2119b71f3564ad81e','url':'/favicon.png'},{'revision':'f4523fa3aae7ea4d962ba78196d90c87','url':'/favicon.svg'},{'revision':'dc1449df6b003c14ab1d410534b30870','url':'/icons/icon-192.png'},{'revision':'203900115f2cbcbe4c8331ecfb2e898b','url':'/icons/icon-512.png'},{'revision':'4d88c2a1620f3c12f95d22b0d015bd1b','url':'/manifest.json'},{'revision':'78b5f4fa1d1c678b36b4305c96a91976','url':'/sw-utils.js'},{'revision':'b8d988788c1afaf877346b49446a22fc','url':'/sw.js'},{'revision':'e3b8c3daacf5fad8919ce3eb93e91b9b','url':'/sync-queue-sw.js'}]||[]),workbox.routing.registerRoute(/^https:\/\/fonts\.googleapis\.com\/.*/i,new CacheFirst({cacheName:"google-fonts-cache",plugins:[new ExpirationPlugin({maxEntries:10,maxAgeSeconds:31536e3})]})),workbox.routing.registerRoute(/\.(?:jpg|jpeg|gif|png|svg|ico|webp)$/i,new StaleWhileRevalidate({cacheName:"static-image-assets",plugins:[new ExpirationPlugin({maxEntries:64,maxAgeSeconds:2592e3})]})),workbox.routing.registerRoute(/\/api\/.*$/i,new NetworkFirst({cacheName:"apis",networkTimeoutSeconds:10,plugins:[new ExpirationPlugin({maxEntries:16,maxAgeSeconds:86400})]}));let i="".concat("https://pcw04dvz-5000.asse.devtunnels.ms","/api");async function l(){console.log("SW: Executing syncScriptUpdates function.");let e=await o();if(!e)return void console.warn("SW: No authentication token found in IndexedDB. Cannot sync updates. Waiting for token.");let t=await a();if(console.log("SW: Found ".concat(t.length," items in sync queue.")),0===t.length)return void console.log("SW: Sync queue is empty. No updates to send.");for(let{key:r,item:o}of t)try{if("UPDATE_SCRIPT"===o.type){console.log("SW: Attempting to sync script update for ID: ".concat(o.data._id));let t=await fetch("".concat(i,"/scripts/update"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(o.data)});if(!t.ok){let e=await t.text();console.error("SW: Sync failed for script ".concat(o.data._id,". Status: ").concat(t.status,". Error: ").concat(e));break}let n=await t.json();if(n.success)console.log("SW: Successfully synced script update for ID: ".concat(o.data._id,". Removing from queue.")),await s(r),await c(n.script||o.data);else{console.error("SW: API returned success:false for script ".concat(o.data._id,". Message: ").concat(n.message||"Unknown",". Leaving in queue."));break}}}catch(e){console.error("SW: Network error or unexpected error during sync for item ".concat(r,":"),e);break}console.log("SW: Script updates sync process completed.")}self.addEventListener("sync",e=>{"sync-script-updates"===e.tag&&(console.log("SW: Caught sync-script-updates event. Starting background sync."),e.waitUntil(l()))})})();